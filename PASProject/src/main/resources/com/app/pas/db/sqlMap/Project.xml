<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Project">

   <typeAlias alias="str" type="java.lang.String" />
   <typeAlias alias="int" type="java.lang.Integer" />
  
   
   <select id="selectProjectList" parameterClass="int" resultClass="Project" >
      select * from PROJECT where PROJ_NUM LIKE '%'||#proj_Num#||'%'
   </select>
   <select id="selectProject" parameterClass="int" resultClass="Project">
   	 select * from project where proj_num = #proj_Num#
   </select>
   
   <select id="selectMyProjectListById" parameterClass="str" resultClass="Project">
    select A.MEM_EMAIL AS MEM_EMAIL, A.PROJ_CONTENT AS PROJ_CONTENT, A.PROJ_NAME AS PROJ_NAME, A.PROJ_NUM AS PROJ_NUM, A.PROJ_CHECK AS PROJ_CHECK
	from project A, (select distinct proj_num from mem_position_view where mem_email = #mem_Email# and pjj_per_num=1)m
	where A.PROJ_NUM = M.PROJ_NUM
	and a.proj_check='y'
   </select>
   
   <select id="selectOtherProjectListById" parameterClass="str" resultClass="Project">
	    select A.MEM_EMAIL AS MEM_EMAIL, A.PROJ_CONTENT AS PROJ_CONTENT, A.PROJ_NAME AS PROJ_NAME, A.PROJ_NUM AS PROJ_NUM, A.PROJ_CHECK AS PROJ_CHECK
		from project A
    	where proj_num not in ( select distinct proj_num from mem_position_view where mem_email =#mem_Email# and pjj_per_Num ='1')    
   </select>
   
   <update id="insertProject" parameterClass="Project">
      insert into PROJECT(PROJ_NUM,MEM_EMAIL,PROJ_CONTENT,PROJ_NAME,MEM_NAME,mem_Img) 
	  VALUES(PROJECT_SEQ.NEXTVAL,#mem_Email#,#proj_Content#,#proj_Name#,#mem_Name#,#mem_Img#)
   </update>
   
   <update id="updateProject" parameterClass="Project">
      UPDATE PROJECT SET MEM_EMAIL=#mem_Email#, PROJ_CONTENT=#proj_Content#,PROJ_CHECK=#proj_Check#,
	  PROJ_NAME=#proj_Name# WHERE PROJ_NUM =#proj_Num#
   </update>
   
   <update id="deleteProject" parameterClass="int">
      delete from PROJECT where PROJ_NUM=#proj_Num#
   </update>
   
   <select id="selectMemPositionViewListByProjNum" parameterClass="int" resultClass="MemPositionView">
   		select * from mem_position_view where pjj_per_num = 1 and proj_num = #proj_Num#
   </select>
   
   <select id = "selectLastInsertProject" parameterClass="str" resultClass="Project">
   		SELECT * FROM (SELECT * FROM project WHERE mem_email=#mem_Email#  ORDER BY proj_Num DESC) WHERE ROWNUM = 1
   </select>
   
   <update id="updateProjectImg" parameterClass="Project">
    update Project set proj_Img=#proj_Img# where proj_Num = #proj_Num#
   </update>
   
   <select id="selectOtherProjectCount" parameterClass="str" resultClass="int">
   
    select count(*)
		from project A
    	where proj_num not in ( select distinct proj_num from mem_position_view where mem_email =#mem_Email# and pjj_per_Num ='1')
   
   </select>
</sqlMap>